# üì• –†–ê–ë–û–¢–ê –° –†–ï–ê–õ–¨–ù–´–ú–ò –î–ê–ù–ù–´–ú–ò

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω Tinkoff API

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **Tinkoff –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏**
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **–¢–æ–∫–µ–Ω—ã –¥–ª—è API**
3. –í—ã–ø—É—Å—Ç–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω —Å –ø—Ä–∞–≤–∞–º–∏ **"–¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ"**
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω (–æ–Ω –±–æ–ª—å—à–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è!)

**–í–∞–∂–Ω–æ**: –¢–æ–∫–µ–Ω –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –ë–æ—Ç –ù–ï —Å–æ–≤–µ—Ä—à–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Å–¥–µ–ª–∫–∏ —á–µ—Ä–µ–∑ API.

### –®–∞–≥ 2: –°–∫–∞—á–∞–π—Ç–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏

```bash
python download_history.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç:
- **–¢–æ–∫–µ–Ω API** - –≤—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω
- **–¢–∏–∫–µ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞** - –Ω–∞–ø—Ä–∏–º–µ—Ä: SBER, GAZP, LKOH, YNDX
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π** - –Ω–∞–ø—Ä–∏–º–µ—Ä: 30

–î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

**–§—å—é—á–µ—Ä—Å—ã:**
- `Si` - –§—å—é—á–µ—Ä—Å –Ω–∞ –¥–æ–ª–ª–∞—Ä –°–®–ê
- `RTS` - –§—å—é—á–µ—Ä—Å –Ω–∞ –∏–Ω–¥–µ–∫—Å –†–¢–°

**–ê–∫—Ü–∏–∏ (blue chips):**
- `SBER` - –°–±–µ—Ä–±–∞–Ω–∫
- `GAZP` - –ì–∞–∑–ø—Ä–æ–º
- `LKOH` - –õ–£–ö–û–ô–õ
- `YNDX` - –Ø–Ω–¥–µ–∫—Å
- `GMKN` - –ù–æ—Ä–Ω–∏–∫–µ–ª—å
- `NVTK` - –ù–æ–≤–∞—Ç—ç–∫
- `ROSN` - –†–æ—Å–Ω–µ—Ñ—Ç—å
- `TATN` - –¢–∞—Ç–Ω–µ—Ñ—Ç—å
- `MGNT` - –ú–∞–≥–Ω–∏—Ç
- `MTSS` - –ú–¢–°

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª: `candles_TICKER_XXdays.csv`

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥

```bash
python main.py
```

–í—ã–±–µ—Ä–∏—Ç–µ:
1. **–§–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏** - –µ—Å–ª–∏ —Å–∫–∞—á–∞–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
2. **–°—Ç—Ä–∞—Ç–µ–≥–∏—é** - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Combined (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è)
3. –î–æ–∂–¥–∏—Ç–µ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –®–∞–≥ 4: –ò–∑—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥–∞ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã:

- `backtest_TICKER_strategy.png` - –ì—Ä–∞—Ñ–∏–∫ —Å —Ç–æ—á–∫–∞–º–∏ –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞
- `trades_TICKER_strategy.csv` - –î–µ—Ç–∞–ª—å–Ω—ã–π –ª–æ–≥ –≤—Å–µ—Ö —Å–¥–µ–ª–æ–∫
- –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ —Å –ø–æ–ª–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
# 1. –°–∫–∞—á–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –°–±–µ—Ä–±–∞–Ω–∫—É –∑–∞ 30 –¥–Ω–µ–π
python download_history.py
# –í–≤–æ–¥–∏–º —Ç–æ–∫–µ–Ω
# –í—ã–±–∏—Ä–∞–µ–º SBER
# –£–∫–∞–∑—ã–≤–∞–µ–º 30 –¥–Ω–µ–π

# 2. –ó–∞–ø—É—Å–∫–∞–µ–º –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥
python main.py
# –í—ã–±–∏—Ä–∞–µ–º "1" - –ó–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥
# –í—ã–±–∏—Ä–∞–µ–º —Ñ–∞–π–ª candles_SBER_30days.csv
# –í—ã–±–∏—Ä–∞–µ–º "4" - Combined —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

# 3. –°–º–æ—Ç—Ä–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
# - –ì—Ä–∞—Ñ–∏–∫: backtest_SBER_30days_combined.png
# - –°–¥–µ–ª–∫–∏: trades_SBER_30days_combined.csv
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–≤–æ–∏—Ö CSV –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ CSV —Ñ–æ—Ä–º–∞—Ç–µ:

### –§–æ—Ä–º–∞—Ç CSV —Ñ–∞–π–ª–∞:

```csv
timestamp,open,high,low,close,volume
2025-11-01 10:00:00,100500.0,100550.0,100450.0,100520.0,1500
2025-11-01 10:01:00,100520.0,100580.0,100510.0,100560.0,1800
...
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –ö–æ–ª–æ–Ω–∫–∞ `timestamp` –≤ —Ñ–æ—Ä–º–∞—Ç–µ datetime
- –ö–æ–ª–æ–Ω–∫–∏ `open`, `high`, `low`, `close`, `volume`
- –ú–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏
- –î–∞–Ω–Ω—ã–µ –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥

### –ó–∞–≥—Ä—É–∑–∫–∞:

```python
from data_loader import DataLoader

# –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –≤–∞—à–µ–≥–æ CSV
data = DataLoader.load_from_csv('your_candles.csv', date_column='timestamp')

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ —Ç–æ—Ä–≥–æ–≤—ã—Ö —á–∞—Å–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
data = DataLoader.filter_trading_hours(data, start_time="10:00", end_time="18:45")
```

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

–ß—Ç–æ–±—ã —Å—Ä–∞–≤–Ω–∏—Ç—å –≤—Å–µ 4 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –æ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö:

```bash
python main.py
# –í—ã–±–µ—Ä–∏—Ç–µ "2" - –°—Ä–∞–≤–Ω–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
```

–ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞:

```
–°—Ç—Ä–∞—Ç–µ–≥–∏—è       | –°–¥–µ–ª–æ–∫ | Win Rate % | PnL    | Profit Factor | Sharpe | Max DD %
Long Pullback   | 25     | 48.0       | 1250   | 1.15          | 0.45   | 12.3
Short Pullback  | 18     | 44.4       | -850   | 0.85          | -0.32  | 18.5
Neutral Range   | 42     | 52.4       | 2100   | 1.42          | 0.68   | 8.2
Combined        | 35     | 54.3       | 3200   | 1.68          | 0.92   | 10.1
```

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `config.py`:

```python
# –ï—Å–ª–∏ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π —Å—Ç–æ–ø–∞ - —É–≤–µ–ª–∏—á—å—Ç–µ
STOP_LOSS_ATR_MULTIPLIER = 2.5  # –±—ã–ª–æ 2.0

# –ï—Å–ª–∏ –Ω–µ –¥–æ—Ç—è–≥–∏–≤–∞–µ—Ç –¥–æ —Ç–µ–π–∫–∞ - —É–º–µ–Ω—å—à–∏—Ç–µ
TAKE_PROFIT_ATR_MULTIPLIER = 3.0  # –±—ã–ª–æ 3.5

# –ï—Å–ª–∏ —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –≤—Ö–æ–¥—ã - —É–≤–µ–ª–∏—á—å—Ç–µ –∫—É–ª–¥–∞—É–Ω
COOLDOWN_MINUTES = 20  # –±—ã–ª–æ 15

# –ï—Å–ª–∏ –º–∞–ª–æ —Å–¥–µ–ª–æ–∫ - —É–º–µ–Ω—å—à–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ ATR
ATR_PERIOD = 10  # –±—ã–ª–æ 14
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ —Å–Ω–æ–≤–∞ –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

## –†–∞–±–æ—Ç–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è (–∏–Ω—Ç—Ä–∞–¥–µ–π)

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

‚úÖ **–¢–æ—Ä–≥—É–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –∑–∞–¥–∞–Ω–Ω—ã–µ —á–∞—Å—ã**
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 10:00 - 18:30
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `config.py`: `TRADING_START_TIME`, `TRADING_END_TIME`

‚úÖ **–ó–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –Ω–æ—á—å**
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ: 23:45 (–ø–∞—Ä–∞–º–µ—Ç—Ä `FORCE_CLOSE_TIME`)
- –í—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ —Ä—ã–Ω–∫—É
- **–ü–æ–∑–∏—Ü–∏–∏ –ù–ò–ö–û–ì–î–ê –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è —á–µ—Ä–µ–∑ –Ω–æ—á—å!**

‚úÖ **–§–∏–ª—å—Ç—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–±–∏—Ä–∞–µ—Ç —Å–≤–µ—á–∏ –≤–Ω–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö —á–∞—Å–æ–≤
- –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –¥–Ω–µ–≤–Ω–æ–π —Å–µ—Å—Å–∏–µ–π

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### ‚ùå "–§–∞–π–ª—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

**–†–µ—à–µ–Ω–∏–µ**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python download_history.py` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### ‚ùå "–°–¥–µ–ª–æ–∫ –Ω–µ –±—ã–ª–æ"

**–ü—Ä–∏—á–∏–Ω—ã**:
1. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö (–Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 200+ —Å–≤–µ—á–µ–π)
2. –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ä—ã–Ω–∫–∞ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
3. –°–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—Ö–æ–¥–∞

**–†–µ—à–µ–Ω–∏–µ**:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Combined —Å—Ç—Ä–∞—Ç–µ–≥–∏—é (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ)
- –°–∫–∞—á–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ –±–æ–ª—å—à–∏–π –ø–µ—Ä–∏–æ–¥ (60-90 –¥–Ω–µ–π)
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç

### ‚ùå "–í—Å–µ —Å–¥–µ–ª–∫–∏ —É–±—ã—Ç–æ—á–Ω—ã–µ"

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `config.py`
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –¥—Ä—É–≥–æ–º –ø–µ—Ä–∏–æ–¥–µ
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –ª–∏–∫–≤–∏–¥–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é

### ‚ùå ImportError: tinkoff-investments

**–†–µ—à–µ–Ω–∏–µ**: 
```bash
pip install tinkoff-investments
```

## –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

**–•–æ—Ä–æ—à–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:**
- ‚úÖ Win Rate > 50%
- ‚úÖ Profit Factor > 1.5
- ‚úÖ Sharpe Ratio > 1.0
- ‚úÖ Max Drawdown < 15%
- ‚úÖ –ú–∏–Ω–∏–º—É–º 30+ —Å–¥–µ–ª–æ–∫ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏

**–°—Ä–µ–¥–Ω—è—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:**
- ‚ö†Ô∏è Win Rate 45-50%
- ‚ö†Ô∏è Profit Factor 1.0-1.5
- ‚ö†Ô∏è Sharpe Ratio 0.5-1.0
- ‚ö†Ô∏è Max Drawdown 15-25%

**–ü–ª–æ—Ö–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:**
- ‚ùå Win Rate < 45%
- ‚ùå Profit Factor < 1.0
- ‚ùå Sharpe Ratio < 0.5
- ‚ùå Max Drawdown > 25%

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥–∞:

1. ‚úÖ **Forward testing** - –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (out-of-sample)
2. ‚úÖ **Walk-forward –∞–Ω–∞–ª–∏–∑** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
3. ‚úÖ **–†–∞–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã** - –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –∞–∫—Ü–∏—è—Ö –∏ —Ñ—å—é—á–µ—Ä—Å–∞—Ö
4. ‚úÖ **–†–∞–∑–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã** - –±—ã—á–∏–π —Ä—ã–Ω–æ–∫, –º–µ–¥–≤–µ–∂–∏–π, –±–æ–∫–æ–≤–∏–∫
5. ‚úÖ **Paper trading** - —Å–∏–º—É–ª—è—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
6. ‚ö†Ô∏è **–†–µ–∞–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è** - —Ç–æ–ª—å–∫–æ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –æ–±—ä—ë–º–æ–º!

---

**–£–¥–∞—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏! üìà**
