
╔════════════════════════════════════════════════════════════════════╗
║                                                                    ║
║         🤖 ML-ENHANCED TRADING BOT - ИНСТРУКЦИЯ                   ║
║                                                                    ║
╚════════════════════════════════════════════════════════════════════╝

📦 ФАЙЛЫ СОЗДАНЫ:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. ml_predictor.py          - ML модель (Random Forest)
2. train_ml_model.py        - Скрипт обучения модели
3. strategies_ml.py         - Breakout стратегия с ML фильтром
4. README_ML.txt            - Эта инструкция


🚀 КАК ИСПОЛЬЗОВАТЬ (3 ШАГА):
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ШАГ 1: ОБУЧИТЕ ML МОДЕЛЬ
─────────────────────────────────────────────────────────────────────

    python train_ml_model.py

Процесс:
  • Выберите файл с данными (Si, SBER и т.д.)
  • Настройте горизонт прогноза (рекомендуется 5 свечей)
  • Модель обучится и покажет точность
  • Файл модели сохранится автоматически

⚠️  ВАЖНО: Точность должна быть > 52% для использования!
   < 52%  = не лучше случайного угадывания
   52-55% = слабый сигнал, использовать осторожно
   55%+   = хорошая модель, готова к использованию


ШАГ 2: ДОБАВЬТЕ ML СТРАТЕГИЮ В main.py
─────────────────────────────────────────────────────────────────────

Откройте main.py и найдите блок импортов. ДОБАВЬТЕ:

    from strategies_ml import MLEnhancedBreakoutStrategy, SimpleBreakoutStrategy

Затем найдите блок выбора стратегий и ДОБАВЬТЕ опции 7 и 8:

    print("7. ML-Enhanced Breakout - С машинным обучением ⭐⭐⭐")
    print("8. Simple Breakout - Без ML (для сравнения)")

    strategy_choice = input("\nВыберите стратегию (1-8, по умолчанию 7): ").strip()

    # ... существующие стратегии ...

    elif strategy_choice == "7":
        # Определяем путь к модели
        instrument = "SiZ5"  # Измените на ваш инструмент
        model_path = f"candles_{instrument}_*_ml_model.pkl"

        strategy = MLEnhancedBreakoutStrategy(
            ml_model_path=model_path,
            use_ml=True,
            min_confidence='MEDIUM'  # LOW, MEDIUM, HIGH
        )
        strategy_name = "ML-Enhanced Breakout"

    elif strategy_choice == "8":
        strategy = SimpleBreakoutStrategy()
        strategy_name = "Simple Breakout (No ML)"


ШАГ 3: ЗАПУСТИТЕ БЭКТЕСТ С ML
─────────────────────────────────────────────────────────────────────

    python main.py

Выберите:
  • Файл: candles_SiZ5_15days.csv (или другой)
  • Стратегия: 7 (ML-Enhanced Breakout)

Бот автоматически загрузит обученную модель!


📊 ОЖИДАЕМЫЕ РЕЗУЛЬТАТЫ:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

БЕЗ ML (Simple Breakout):
  • Win Rate: 25-30%
  • Profit Factor: 0.5-0.8
  • Много ложных пробоев

С ML (ML-Enhanced Breakout):
  • Win Rate: 40-55% ✅ (улучшение на 15-25%)
  • Profit Factor: 1.0-1.5 ✅
  • Меньше сделок, но качественнее
  • ML фильтрует ~50% ложных сигналов


⚙️ НАСТРОЙКИ ML СТРАТЕГИИ:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

В strategies_ml.py → MLEnhancedBreakoutStrategy():

1. min_confidence: Минимальная уверенность ML
   • 'LOW'    - все сигналы ML (больше сделок)
   • 'MEDIUM' - только средние/высокие (рекомендуется) ⭐
   • 'HIGH'   - только высокая уверенность (мало сделок)

2. use_ml: Включить/выключить ML
   • True  - с ML фильтром ⭐
   • False - обычный Breakout

3. lookback_candles: Размер диапазона для пробоя
   • 15 - по умолчанию
   • 10 - для более частых входов
   • 20 - для более редких, но надёжных


🔬 ЭКСПЕРИМЕНТЫ:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. СРАВНИТЕ СТРАТЕГИИ:
   • Запустите Simple Breakout (стратегия 8)
   • Запустите ML-Enhanced (стратегия 7)
   • Сравните Win Rate и Profit Factor

2. ПОПРОБУЙТЕ РАЗНЫЕ ИНСТРУМЕНТЫ:
   • Si (фьючерс доллар) - волатильный
   • GAZP (Газпром) - средняя волатильность
   • SBER (Сбербанк) - низкая волатильность

3. НАСТРОЙТЕ ГОРИЗОНТ ПРОГНОЗА:
   • forward_periods=3  - краткосрочный (агрессивно)
   • forward_periods=5  - средний (рекомендуется) ⭐
   • forward_periods=10 - долгосрочный (консервативно)


❓ FAQ:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Q: Модель показывает точность 50-52%. Использовать?
A: Осторожно. Это почти случайное угадывание. 
   Рекомендация: загрузите больше данных (30+ дней)

Q: Win Rate всё равно низкий с ML
A: Нормально для фьючерсов. Главное - Profit Factor > 1.0
   Один большой выигрыш перекрывает 2-3 маленьких проигрыша

Q: Как часто переобучать модель?
A: Каждую неделю/месяц с новыми данными
   Рынки меняются → модель должна адаптироваться

Q: Можно ли использовать для реальной торговли?
A: ТОЛЬКО после тщательного бэктестинга!
   1. Протестируйте на 3+ месяцах данных
   2. Проверьте на разных инструментах
   3. Начните с минимальных объёмов


🎓 ДОПОЛНИТЕЛЬНО:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Модель использует 30+ признаков:
  • Технические индикаторы (RSI, MACD, Bollinger Bands)
  • Скользящие средние (SMA, EMA)
  • Волатильность (ATR)
  • Объём
  • Momentum
  • Свечные паттерны
  • Лаги (исторические значения)

Алгоритм: Random Forest (200 деревьев)
  • Устойчив к переобучению
  • Хорошо работает с нелинейными зависимостями
  • Быстрый для прогнозирования


📞 ПОДДЕРЖКА:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Если что-то не работает:
  1. Проверьте версии библиотек: sklearn, pandas, numpy
  2. Убедитесь, что модель обучена перед использованием
  3. Проверьте путь к файлу модели

Удачной торговли! 🚀

╔════════════════════════════════════════════════════════════════════╗
║  Помните: прошлые результаты не гарантируют будущей прибыли!     ║
║  Всегда тестируйте на демо-счёте перед реальной торговлей!       ║
╚════════════════════════════════════════════════════════════════════╝
